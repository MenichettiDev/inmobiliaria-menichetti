@if (ViewBag.ErrorMessage != null)
{
    <div class="alert alert-danger">
        @ViewBag.ErrorMessage
    </div>
}

@model InmobiliariaApp.Models.Usuario
@{
    ViewData["Title"] = "Editar Usuario";
}

<h1>Editar Usuario</h1>
<hr />
<form asp-action="Editar">
    <input type="hidden" asp-for="IdUsuario" />
    <div class="form-group">
        <label asp-for="Email"></label>
        <input asp-for="Email" class="form-control" />
        <span asp-validation-for="Email" class="text-danger"></span>
    </div>

    @* <div class="form-group">
        <label asp-for="Password"></label>
        <input asp-for="Password" class="form-control" type="password" />
        <span asp-validation-for="Password" class="text-danger"></span>
    </div> *@

    @if (User.IsInRole("Administrador"))
    {
        <div class="form-group">
            <label asp-for="Rol"></label>
            <select asp-for="Rol" class="form-control">
                <option value="Administrador">Administrador</option>
                <option value="Empleado">Empleado</option>
            </select>
            <span asp-validation-for="Rol" class="text-danger"></span>
        </div>
    }
    else
    {
        <!-- Campo oculto para que no se pierda el valor -->
        <input type="hidden" asp-for="Rol" />
    }

    <div class="form-check mb-3">
        <input type="checkbox" class="form-check-input" id="cambiarPassword" onchange="togglePasswordFields()" />
        <label class="form-check-label" for="cambiarPassword">Cambiar contrase単a</label>
    </div>

    <div id="passwordFields" style="display: none;">
        <div class="form-group">
            <label for="PasswordActual">Contrase単a actual</label>
            <input type="password" name="PasswordActual" id="PasswordActual" class="form-control" />
        </div>
        <div class="form-group">
            <label for="NuevaPassword">Nueva contrase単a</label>
            <input type="password" name="NuevaPassword" id="NuevaPassword" class="form-control" />
        </div>
        <div class="form-group">
            <label for="ConfirmarPassword">Confirmar nueva contrase単a</label>
            <input type="password" name="ConfirmarPassword" id="ConfirmarPassword" class="form-control" />
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Actualizar</button>
    <a asp-action="Listar" class="btn btn-secondary">Cancelar</a>
    
</form>


@section Scripts {
    <script>
        function togglePasswordFields() {
            var check = document.getElementById('cambiarPassword');
            var passwordFields = document.getElementById('passwordFields');
            passwordFields.style.display = check.checked ? 'block' : 'none';
        }
    </script>
}